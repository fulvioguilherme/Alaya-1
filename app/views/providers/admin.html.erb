<% provide(:title, @admin.first_name) %>
    <!--=== Container ===-->
    <div class="container content">
        <div class="row margin-bottom-30">
            <div class="col-md-10 col-md-offset-1 mb-margin-bottom-30">
                <% flash.each do |key, value| %>
                    <div class="alert alert-danger" role="alert"><span class="glyphicon glyphicon-remove"></span> <strong><%= key %></strong> <%= value %>
                       <button type="button" class="close" data-dismiss="alert"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                    </div>
                <% end %>

                <% if !@alert.nil? %>
                    <div class="alert alert-<%= @alert["type"] %>" role="alert"><span class="glyphicon glyphicon-remove"></span> <strong><%= @alert["strong"] %></strong> <%= @alert["message"] %>
                       <button type="button" class="close" data-dismiss="alert"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                    </div>
                <% end %>

                <div class="headline"><h2>System Admin</h2></div>
                
                <!-- Requests table begin -->
                <ul class="nav nav-tabs" role="tablist">
                    <li class="active"><a href="#requests" role="tab" data-toggle="tab"><span class="glyphicon glyphicon-star"></span> Requests</a></li>
                    <li class=""><a href="#schedule" role="tab" data-toggle="tab"><span class="glyphicon glyphicon-calendar"></span> Schedule</a></li>
                    <li class=""><a href="#providers" role="tab" data-toggle="tab"><span class="glyphicon glyphicon-tree-deciduous"></span> Providers</a></li>
                    <li class=""><a href="#clients" role="tab" data-toggle="tab"><span class="glyphicon glyphicon-user"></span> Clients</a></li>
                    <li class=""><a href="#config" role="tab" data-toggle="tab"><span class="glyphicon glyphicon-cog"></span> Configuration</a></li>
                </ul>
                <div class="tab-content">
                    <div class="tab-pane active" id="requests">
                        <% if @appointments_not_accepted.length > 0 %>
                            <h2>Request waiting for acceptance</h2>
                            <table class="table table-striped table-hover">
                                <thead>
                                    <tr>
                                        <th>Provider</th>
                                        <th>Client</th>
                                        <th>Email</th>
                                        <th>Phone</th>
                                        <th>Date</th>
                                        <th>Accept</th>
                                        <th>Details</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <% @appointments_not_accepted.each_with_index do |appointment, index| %>
                                        <tr>
                                            <td><%= appointment.provider.first_name %> <%= appointment.provider.last_name %></td>
                                            <td><%= appointment.client.first_name %> <%= appointment.client.last_name %></td>
                                            <td><%= appointment.client.email %></td>
                                            <td><%= appointment.client.phone %></td>
                                            <td><%= (appointment.start + 20.minutes).strftime("%H:%M:%S - %A, %B %dth, %Y") %></td>
                                            <td align="center">
                                                <%= link_to admin_path(:accept_appointment_id => appointment.id) do %>
                                                    <span class="glyphicon glyphicon-thumbs-up" title="Accept request"></span>
                                                <% end %>
                                            </td>
                                            <td align="center">
                                                <%= link_to appointment_detail_path(:id => appointment.id) do %>
                                                    <span class="glyphicon glyphicon-circle-arrow-right" title="Detailed request"></span>
                                                <% end %>
                                            </td>
                                        </tr>
                                    <% end %>
                                </tbody>
                            </table>
                        <% else %>
                            <h2>There are not requests waiting for acceptance</h2>
                        <% end %>
                    </div>
                    <div class="tab-pane" id="schedule">
                        <h2>Scheduling monitor</h2>

                        <div class="row margin-bottom-20">
                            <form id="schedules_periodicity" action="#" method="post">
                                <div class="col-md-4 col-md-offset-0">
                                    <label for="c_provider_id"><strong><span class="glyphicon glyphicon-chevron-right"></span> Provider:</strong></label>
                                    <select name="c_provider_id" id="c_provider_id" class="form-control">
                                        <% @providers.each_with_index do |provider, index| %>
                                            <option value="<%= provider.id %>"><%= provider.first_name %> <%= provider.last_name %></option>
                                        <% end %>
                                    </select>
                                </div>
                                <div class="col-md-8 col-md-offset-0">
                                    <label><strong><span class="glyphicon glyphicon-chevron-right"></span> Periodicity:</strong></label>
                                    <br>
                                    <label class="radio-inline">
                                        <input type="radio" onchange="loadSchedule();" name="periodicity" id="p_monthly" value="1" checked>Monthly
                                    </label>
                                    <label class="radio-inline">
                                        <input type="radio" onchange="loadSchedule();" name="periodicity" id="p_weekly" value="2">Weekly
                                    </label>
                                    <!--
                                    <label class="radio-inline">
                                        <button type="button" onclick="loadSchedule();" class="btn btn-danger btn-large" ><span class="glyphicon glyphicon-refresh"></span> Load Schedule</button>
                                    </label>
                                    -->
                                    <!-- begin: varibles to be used by ajax -->
                                    <input type="hidden" name="c_client_id" id="c_client_id" value="0">
                                    <input type="hidden" name="c_client_complete" id="c_client_complete" value="0">
                                    <input type="hidden" name="c_client_first_name" id="c_client_first_name" value="0">
                                    <input type="hidden" name="c_client_last_name" id="c_client_last_name" value="0">
                                    <input type="hidden" name="c_provider_first_name" id="c_provider_first_name" value="0">
                                    <input type="hidden" name="c_provider_last_name" id="c_provider_last_name" value="0">
                                    <input type="hidden" name="c_provider_expertise" id="c_provider_expertise" value="0">
                                    <input type="hidden" name="is_admin" id="is_admin" value="1">
                                    <!-- end: varibles to be used by ajax -->
                                </div>
                            </form>
                        </div>

                        <div class="panel-body margin-bottom-40">
                            <div id="my-calendar">
                                <div id="schedules_body_alert"></div>
                                <div class="row">
                                    <div class="col-xs-12" id="schedules_container"></div>
                                </div>
                                <div class="modal fade" id="schedules_modal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
                                    <div class="modal-dialog">
                                        <div class="modal-content">
                                            <div class="modal-header">
                                                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                                                <h4 class="modal-title" id="schedules_title"></h4>
                                            </div>
                                            <div class="modal-body">
                                                <form action="" method="post">
                                                    <div id="schedules_alert"></div>
                                                    <div id="schedulse_modal_content"></div>
                                                    <div class="modal-footer">
                                                        <button type="button" class="btn btn-default" data-dismiss="modal"><span class="glyphicon glyphicon-remove" title="Cancel"></span> Cancel</button>
                                                        &nbsp;<a href="#" id="schedules_modal_action" class="btn-u pull-right"></a>
                                                    </div>
                                                </form>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="tab-pane" id="providers">
                        
                    </div>
                    <div class="tab-pane" id="clients">
                        
                    </div>    
                    <div class="tab-pane" id="config">
                        
                    </div>
                </div>
                <!-- Requests table end -->
            </div>
        </div><!--/row-->        
    </div>
    <!--=== End Container ===-->
